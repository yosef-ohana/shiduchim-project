package com.example.myproject.repository;

import com.example.myproject.model.UserAction;
import com.example.myproject.model.UserActionType;
import com.example.myproject.model.UserActionCategory;
import com.example.myproject.model.User;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

import java.time.LocalDateTime;
import java.util.List;

@Repository
public interface UserActionRepository extends JpaRepository<UserAction, Long> {

    // ğŸ”µ ×¤×¢×•×œ×•×ª ×œ×¤×™ ××™ ×©×‘×™×¦×¢
    List<UserAction> findByActor(User actor);                        // ×›×œ ×”×¤×¢×•×œ×•×ª ×©×œ×™
    List<UserAction> findByActorAndActiveTrue(User actor);           // ×¤×¢×•×œ×•×ª ×¤×¢×™×œ×•×ª ×©×œ×™
    List<UserAction> findByActorAndActionTypeAndActiveTrue(User actor, UserActionType type); // ×¤×¢×•×œ×•×ª ××¡×•×’ ××¡×•×™× ×©×œ×™

    // ğŸ”µ ×œ×¤×™ ××–×”×” Actor
    List<UserAction> findByActorId(Long actorId);
    List<UserAction> findByActorIdAndActiveTrue(Long actorId);

    // ğŸ”µ ×¤×¢×•×œ×•×ª ×©× ×¢×©×• ×¢×œ×™×™
    List<UserAction> findByTarget(User target);
    List<UserAction> findByTargetAndActiveTrue(User target);
    List<UserAction> findByTargetAndActionType(User target, UserActionType type);

    // ğŸ”µ ×œ×¤×™ ××–×”×” Target
    List<UserAction> findByTargetId(Long targetId);
    List<UserAction> findByTargetIdAndActiveTrue(Long targetId);

    // ğŸ”µ ×¤×¢×•×œ×” ××—×¨×•× ×” ×‘×™×Ÿ ×©× ×™ ××©×ª××©×™×
    UserAction findTopByActorAndTargetAndActionTypeAndActiveTrueOrderByCreatedAtDesc(
            User actor, User target, UserActionType type
    );

    UserAction findTopByActorAndTargetOrderByCreatedAtDesc(
            User actor, User target
    );

    // ğŸ”µ ×›×œ ×”×™×¡×˜×•×¨×™×™×ª ×”×¤×¢×•×œ×•×ª ×‘×™× ×™×”×
    List<UserAction> findByActorAndTarget(User actor, User target);

    // ğŸ”µ ×œ×¤×™ ×¡×•×’ ×¤×¢×•×œ×”
    List<UserAction> findByActionType(UserActionType type);

    // ğŸ”µ ×œ×¤×™ ×§×˜×’×•×¨×™×”
    List<UserAction> findByCategory(UserActionCategory category);

    // ğŸ”µ ×œ×¤×™ ×—×ª×•× ×”
    List<UserAction> findByWeddingId(Long weddingId);
    List<UserAction> findByOriginWeddingId(Long weddingId);

    // ğŸ”µ ×œ×¤×™ ×××¥'
    List<UserAction> findByMatchId(Long matchId);

    // ğŸ”µ ×œ×¤×™ groupId
    List<UserAction> findByActionGroupId(Long actionGroupId);

    // ğŸ”µ ×œ×¤×™ ××§×•×¨ ×¤×¢×•×œ×”
    List<UserAction> findBySource(String source);

    // ğŸ”µ ×¤×¢×•×œ×•×ª ××•×˜×•××˜×™×•×ª
    List<UserAction> findByAutoGeneratedTrue();
    List<UserAction> findByAutoGeneratedFalse();

    // ğŸ”µ ×¤×¢×•×œ×•×ª ×¤×¢×™×œ×•×ª / ×œ× ×¤×¢×™×œ×•×ª
    List<UserAction> findByActiveTrue();
    List<UserAction> findByActiveFalse();

    // ğŸ”µ ×œ×¤×™ ×˜×•×•×—×™ ×–××Ÿ (×¡×˜×˜×™×¡×˜×™×§×•×ª / Cron)
    List<UserAction> findByCreatedAtAfter(LocalDateTime time);
    List<UserAction> findByCreatedAtBefore(LocalDateTime time);
    List<UserAction> findByCreatedAtBetween(LocalDateTime start, LocalDateTime end);

    // â­ ×—×“×© â€” ×¨×©×™××•×ª (Like/Freeze/Maybe/Waiting)
    List<UserAction> findByActorIdAndListName(Long actorId, String listName);  // ×›×œ ×”×¤×¢×•×œ×•×ª ×‘×¨×©×™××” ××¡×•×™××ª
}